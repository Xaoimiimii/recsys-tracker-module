!function(){"use strict";async function e(e,n){return await new Promise(e=>setTimeout(e,500)),[{id:1,name:"Áo Thun Nam Đơn Giản",img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQflPrgv4PvP55D0Qhg8nfVjey8Azwm-cDGbw&s",price:"199.000đ"},{id:2,name:"Giày Sneaker Thể Thao",img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQflPrgv4PvP55D0Qhg8nfVjey8Azwm-cDGbw&s",price:"799.000đ"},{id:3,name:"Túi Đeo Chéo Unisex",img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQflPrgv4PvP55D0Qhg8nfVjey8Azwm-cDGbw&s",price:"249.000đ"}]}function n(e,n){return!(n&&0!==n.length&&!n.includes("*"))||n.some(n=>{if("/"===n)return"/"===e;if(n.endsWith("/*")){const t=n.slice(0,-2);return e.startsWith(t)}return e===n})}let t=null,i=null;const o=1e4;function r(){t&&clearTimeout(t);const c=Math.floor(1e4*Math.random()+o);t=setTimeout(()=>{n(window.location.pathname,i.pages)?async function(){const n=await e(i.slotName);n&&n.length>0&&function(e){const n=document.getElementById("myrec-popup-host");n&&n.remove();const t=document.createElement("div");t.id="myrec-popup-host",document.body.appendChild(t);const i=t.attachShadow({mode:"open"}),o=document.createElement("style");o.textContent="\n        :host { all: initial; font-family: Arial, sans-serif; }\n        * { box-sizing: border-box; }\n\n        .myrec-popup {\n            position: fixed; bottom: 24px; right: 24px; width: 340px;\n            background: #fff; border-radius: 12px;\n            box-shadow: 0 4px 28px rgba(0,0,0,0.25);\n            z-index: 2147483647; overflow: hidden;\n            animation: myrec-fadein 0.3s ease;\n            display: flex; flex-direction: column;\n            border: 1px solid #e0e0e0;\n        }\n        @keyframes myrec-fadein { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }\n\n        .myrec-header {\n            background: #111; color: #fff; padding: 12px 14px;\n            font-size: 15px; font-weight: bold;\n            display: flex; justify-content: space-between; align-items: center;\n        }\n        .myrec-close { \n            cursor: pointer; font-size: 18px; line-height: 1; \n            opacity: 0.8; background: none; border: none; color: white; \n        }\n        .myrec-close:hover { opacity: 1; }\n\n        .myrec-body { position: relative; height: 220px; background: #fff; }\n        \n        .myrec-nav {\n            position: absolute; top: 50%; transform: translateY(-50%);\n            font-size: 20px; background: rgba(255,255,255,0.8); border: 1px solid #ddd;\n            cursor: pointer; width: 30px; height: 30px; border-radius: 50%;\n            display: flex; align-items: center; justify-content: center;\n            z-index: 2; transition: all 0.2s; color: #333;\n        }\n        .myrec-nav:hover { background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }\n        .myrec-prev { left: 10px; }\n        .myrec-next { right: 10px; }\n\n        .myrec-slide { text-align: center; padding: 15px; height: 100%; display: flex; align-items: center; justify-content: center; }\n        \n        .myrec-item {\n            display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; text-decoration: none; color: inherit;\n        }\n        .myrec-item img { width: 180px; height: 130px; border-radius: 8px; object-fit: cover; }\n        .myrec-name { font-size: 16px; font-weight: 600; margin: 5px 0 0; color: #333; }\n        .myrec-price { font-size: 14px; color: #d10000; font-weight: bold; }\n    ",i.appendChild(o);const c=document.createElement("div");c.className="myrec-popup",c.innerHTML='\n        <div class="myrec-header">\n            Gợi ý dành cho bạn\n            <button class="myrec-close">&#10005;</button>\n        </div>\n        <div class="myrec-body">\n            <button class="myrec-nav myrec-prev">◀</button>\n            <div class="myrec-slide"></div>\n            <button class="myrec-nav myrec-next">▶</button>\n        </div>\n    ',i.appendChild(c);let a=0,s=null;const l=5e3,d=c.querySelector(".myrec-slide");function m(){const n=e[a],t=n.name||n.title,i=n.img||n.image;d.innerHTML=`\n            <div class="myrec-item" data-id="${n.id}">\n                <img src="${i}" alt="${t}" />\n                <div class="myrec-name">${t}</div>\n                <div class="myrec-price">${n.price}</div>\n            </div>\n        `}function p(){a=(a+1)%e.length,m(),f()}function u(){a=(a-1+e.length)%e.length,m(),f()}function f(){s&&clearTimeout(s),s=setTimeout(p,l)}c.querySelector(".myrec-prev").onclick=u,c.querySelector(".myrec-next").onclick=p,c.querySelector(".myrec-close").onclick=()=>{t.remove(),s&&clearTimeout(s),r()},d.onclick=e=>{const n=e.target.closest(".myrec-item");if(n){n.getAttribute("data-id")}},m(),f()}(n)}():r()},c)}function c(n,t){const i=n.selector,o=async t=>{if(!t||"true"===t.getAttribute("data-myrec-loaded"))return;t.setAttribute("data-myrec-loaded","true");const i=await e(n.slotName);i&&i.length>0&&function(e,n){try{let t=e.shadowRoot;t||(t=e.attachShadow({mode:"open"})),t.innerHTML="";const i=document.createElement("style");i.textContent="\n        :host { \n            display: block; \n            all: initial; \n            font-family: Arial, sans-serif; \n            width: 100%;\n        }\n        * { box-sizing: border-box; }\n\n        .rec-wrapper {\n            display: grid;\n            /* Tự động chia cột: nhỏ nhất 140px, còn lại tự giãn đều */\n            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\n            gap: 16px;\n            padding: 10px 0;\n        }\n\n        .rec-item {\n            border: 1px solid #eee;\n            border-radius: 8px;\n            overflow: hidden;\n            background: #fff;\n            cursor: pointer;\n            transition: transform 0.2s, box-shadow 0.2s;\n            display: flex;\n            flex-direction: column;\n        }\n        .rec-item:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 4px 12px rgba(0,0,0,0.08);\n        }\n\n        .rec-img-box {\n            width: 100%;\n            padding-top: 100%; /* Tạo khung vuông tỷ lệ 1:1 */\n            position: relative;\n            background: #f9f9f9;\n        }\n        .rec-img-box img {\n            position: absolute; top: 0; left: 0;\n            width: 100%; height: 100%; object-fit: cover;\n        }\n\n        .rec-info { padding: 10px; flex-grow: 1; display: flex; flex-direction: column; }\n        \n        .rec-title {\n            font-size: 14px; font-weight: 600; color: #333; margin-bottom: 4px;\n            /* Cắt chữ nếu dài quá 2 dòng */\n            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;\n        }\n        \n        .rec-price {\n            font-size: 14px; color: #d0021b; font-weight: bold; margin-top: auto;\n        }\n    ",t.appendChild(i);const o=document.createElement("div");o.className="rec-wrapper",n.forEach(e=>{const n=e.name||e.title,t=e.img||e.image,i=document.createElement("div");i.className="rec-item",i.setAttribute("data-id",e.id),i.innerHTML=`\n                <div class="rec-img-box">\n                    <img src="${t}" alt="${n}">\n                </div>\n                <div class="rec-info">\n                    <div class="rec-title">${n}</div>\n                    <div class="rec-price">${e.price}</div>\n                </div>\n            `,o.appendChild(i)}),t.appendChild(o),o.addEventListener("click",e=>{const n=e.target.closest(".rec-item");if(n){n.getAttribute("data-id")}})}catch(t){}}(t,i)};document.querySelectorAll(i).forEach(e=>o(e));let r=null;new MutationObserver(e=>{r&&clearTimeout(r),r=setTimeout(()=>{document.querySelectorAll(i).forEach(e=>o(e))},100)}).observe(document.body,{childList:!0,subtree:!0})}const a=Object.freeze(Object.defineProperty({__proto__:null,initInline:c},Symbol.toStringTag,{value:"Module"}));!function(){const t=window.RecSysConfig||{},o=document.currentScript,s=t.storeId||(null==o?void 0:o.getAttribute("data-site-id"));if(!s)return;let l=t.placements||[];if(0===l.length&&o){const e=o.getAttribute("data-mode")||"popup",n=o.getAttribute("data-target-selector");l.push({mode:e,slotName:"default-slot",selector:n,pages:["*"]})}l.forEach(e=>{if(n(window.location.pathname,e.pages))switch(e.mode){case"popup":!function(e){i=e,r()}(e);break;case"custom_widget":e.selector=e.selector||".myrec-widget",c(e);break;case"inline":e.selector&&c(e)}}),window.MyRecSDK={recommend:async function(n){if(n&&n.slot)try{const t=await e(n.slot);n.onResult&&"function"==typeof n.onResult&&n.onResult(t)}catch(t){}},scanWidgets:function(){l.forEach(e=>{"custom_widget"!==e.mode&&"inline"!==e.mode||Promise.resolve().then(()=>a).then(n=>n.initInline(e,s))})}}}()}();
